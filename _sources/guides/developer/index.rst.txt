Developer Guide
===============

This guide will cover the most important Paracell concepts when working with the Paracell API. Below are all the imports we will use. It's helpful to paste them at the top of the notebook or python file you're using to follow this tutorial. The specific paracell imports will be explained as they are used.

.. code-block:: python

   import os
   import cv2
   import numpy as np
   import matplotlib.pyplot as plt

   from paracell.paradata import FOV
   from paracell.manager import FOVManager
   from paracell.segmentation.segmentors import DefaultCellposeSegmentor, ThreeChannelCellposeSegmentor, CellposeLoadSegmentor
   from paracell.improcess.ops import thresh_img, RGBColor
   from paracell.improcess.plotting import get_merged_fov_image, get_outlined_image, get_outlined_fov, get_cell_gallery
   from paracell.feature_extraction.vision import BasicShapeAnalysis

In addition to the imports, we will also define some important global constants used throughout the tutorial. Don't worry too much about them now. They will make more sense when they get used. Refer back to the descriptions then.

.. code-block:: python

   RAW_IMAGE_DIR = "/mnt/DQX/microscopy_data_raw/CDH1_Images/CDH1_KO5/Screen_001/processed"
   SAMPLE_IMAGE_PATH = "/mnt/FNX/Datasets/3ch_cellpose/original/train/CDH1_KO5/A2--W00002--P00064--Z00002--T00000.tif"
   SEG_DIR = "/mnt/FNX/paracell2_outputs/analysis_outputs/CDH1/CDH1_KO5_Tutorial_Sample"
   SEG_SAVE_DIR = "/mnt/FNX/paracell2_outputs/Sandbox/tutorial"
   SEG_SAVE_PATH = os.path.join(SEG_SAVE_DIR, "A2--W00002--P00064--Z00002--T00000_seg.npz")
   THREE_CHANNEL_SEGMENTATION_MODEL_PATH = "/mnt/FNX/paracell2_outputs/three_channel_models/3ch_gfp_fs_v3/3ch_gfp_fs_v3.pt"

- ``RAW_IMAGE_DIR`` is the directory with raw microscope images. It should be in :doc:`this <../../dataset/raw_image_dir>` format.
- ``SAMPLE_IMAGE_PATH`` is the path to a coloured tiff image. It should have three channels.
- ``SEG_DIR`` is the directory containing :doc:`seg files <../../dataset/seg>` for the corresponding ``RAW_IMAGE_DIR``. Likely an directory of :doc:`pipeline output <../../dataset/pipeline_output>` format, generated by running analysis or pseudolabelling.
- ``SEG_SAVE_DIR`` is the folder we will save temporary data for this tutorial.
- ``THREE_CHANNEL_SEGMENTATION_MODEL_PATH`` is the path to the three channel GFP segmentation model.

.. toctree::
   :maxdepth: 2
   :caption: Sections in order

   fov
   segmentation
   visualization
   feature_extraction
   plates_wells_bulk
   misc
